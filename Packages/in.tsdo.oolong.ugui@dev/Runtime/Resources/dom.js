var M=Object.defineProperty;var q=(i,t)=>{for(var e in t)M(i,e,{get:t[e],enumerable:!0})};var v={};q(v,{HttpRequest:()=>c,MithrilTick:()=>H,UnimlementedURLSearchParams:()=>f,UnimplementedFormData:()=>g,UnityDocument:()=>d,UnityElement:()=>l,UnityFragment:()=>a,UnityHistory:()=>m,UnityLocation:()=>p,UnityNode:()=>u,UnityTextNode:()=>o,UnityWindow:()=>b,addEventListener:()=>L,document:()=>C,history:()=>S,location:()=>I,requestAnimationFrame:()=>A,unityDocument:()=>h,unityHistory:()=>O,unityLocation:()=>_,unityWindow:()=>F,window:()=>s});var c=class i{static{this.baseURL=null}constructor(){this.request=new CS.UnityEngine.Networking.UnityWebRequest}abort(){this.request.Abort()}setRequestHeader(t,e){this.request.SetRequestHeader(t,e)}open(t,e,n){this.request.method=t,e.startsWith("/")?this.request.url=i.baseURL+e:this.request.url=e}send(t){if(t!=null)if(typeof t!="string")CS.TSF.Oolong.UGUI.UnityWebRequestExtension.SetBody(this.request,t);else{var e=new TextEncoder().encode(t);CS.TSF.Oolong.UGUI.UnityWebRequestExtension.SetBody(this.request,e)}this.withCredentials,CS.TSF.Oolong.UGUI.UnityWebRequestExtension.SendWithCallback(this.request,()=>{this.onreadystatechange&&this.onreadystatechange({target:this})})}get response(){return this.responseType=="json"?JSON.parse(this.request.downloadHandler.text):this.responseType=="arraybuffer"?CS.TSF.Oolong.UGUI.UnityWebRequestExtension.GetArrayBuffer(this.request.downloadHandler):this.request.downloadHandler.text}get readyState(){return this.request.isDone?4:3}get status(){return this.request.responseCode}get statusText(){return this.request.error}set timeout(t){this.request.timeout=Math.ceil(t/1e3)}},y=i=>i.filter(e=>e instanceof o).map(e=>e.nodeText).join(""),E=i=>{if(i!=null)return i instanceof o?`[${i.nodeText}]`:i.id!=null?`<${i.tag} id=${i.id}/>`:`<${i.tag}/>`},u=class i{constructor(){this.children=[];this._id=null}get id(){return this._id}set id(t){let e=this._id;if(this._id=t==null?null:t.toString(),this instanceof l){var n=h.elementIdMap[e];if(n!=null){let x=n.indexOf(this);x>=0&&n.splice(x,1),n.length===0&&delete h.elementIdMap[e]}this._id!=null&&(h.elementIdMap[this._id]==null&&(h.elementIdMap[this._id]=[]),h.elementIdMap[this._id].push(this)),this.parent?.renameChildId(this,e,this._id);let r=this.mono;r&&r.SetElementAttribute("id",this._id)}}get childNodes(){return this.children}findChildById(t){if(this.childrenMap!=null&&this.childrenMap[t]!=null)return this.childrenMap[t]?.[0];for(let e=0;e<this.children.length;e++){let n=this.children[e];if(n instanceof i){let r=n.findChildById(t);if(r!=null)return r}}}findChildrenById(t,e=[]){this.childrenMap!=null&&this.childrenMap[t]!=null&&e.push(...this.childrenMap[t]);for(let n=0;n<this.children.length;n++){let r=this.children[n];r instanceof i&&r.findChildrenById(t)}return e}elementIndex(t){let e=0;for(let n=0;n<this.children.length;n++){let r=this.children[n];if(r===t)return{nodes:n,elements:e};r instanceof l&&e++}return null}setText(t){if(this.children.length>0){console.warn("Element is not empty when setText is called");return}if(this.children.splice(0,this.children.length),t.length!==0){var e=new o(t);e.parent=this,this.children.push(e),this.setAttribute("#",t)}}get parentElement(){return this.parent}get parentNode(){return this.parent}get innerHTML(){return y(this.children)}set innerHTML(t){this.setText(t)}get textContent(){return y(this.children)}set textContent(t){this.setText(t)}get firstChild(){return this.children[0]}get lastChild(){return this.children[this.children.length-1]}updateText(){this.setAttribute("#",y(this.children))}addChildId(t,e){this.childrenMap==null&&(this.childrenMap={}),this.childrenMap[t]==null&&(this.childrenMap[t]=[]),this.childrenMap[t].push(e)}removeChildId(t,e){if(this.childrenMap==null)return;var n=this.childrenMap[t];if(n==null)return;let r=n.indexOf(e);r>=0&&n.splice(r,1),n.length===0&&delete this.childrenMap[t]}appendChild(t){if(t.parent!=null&&!(t.parent instanceof a)&&console.warn("Unexpected child.parent when appendChild"),t instanceof a){let e=[...t.children];for(let n of e)this.appendChild(n);return}t.parent!=null&&t.parent.removeChild(t),t.parent=this,this.children.push(t),t instanceof l&&(t.id!=null&&this.addChildId(t.id,t),this.attachChildInternal(t)),t instanceof o&&this.updateText()}removeChild(t){t.parent=null;let e=this.children.indexOf(t);if(e<0){console.warn("Can not find child when removeChild");return}this.children.splice(e,1),t instanceof l&&(t.id!=null&&this.removeChildId(t.id,t),this.removeChildInternal(t)),t instanceof o&&this.updateText()}renameChildId(t,e,n){e!=null&&this.removeChildId(e,t),n!=null&&this.addChildId(n,t)}insertBefore(t,e){t.parent!=null&&console.warn("Unexpected child.parent when insertBefore");let n=this.elementIndex(e);if(n==null){console.warn("Can not find the element when insertBefore");return}t.parent=this,this.children.splice(n.nodes,0,t),t instanceof l&&this.insertChildInternal(t,n.elements),t instanceof o&&this.updateText()}toJSON(){return{type:this instanceof a?"fragment":"element",node:E(this),parent:E(this.parent),children:this.children.map(t=>t.toJSON())}}},a=class extends u{constructor(){super(),this.tag=""}setAttribute(){}removeAttribute(){}attachChildInternal(){}removeChildInternal(){}insertChildInternal(){}},w=(i,t,e,n)=>{typeof n=="function"?n({type:t,target:i,eventData:e}):typeof n=="object"&&n.handleEvent({type:t,target:i,eventData:e})},l=class extends u{constructor(e,n){super();this.attrs=new Proxy(this,{get(e,n){return e.getAttribute(n.toString())},set(e,n,r){return e.setAttribute(n.toString(),r)}});typeof e=="string"?this.mono=CS.TSF.Oolong.UGUI.DocumentUtils.CreateElement(e):this.mono=e,this.tag=this.mono.TagName,this.events={},this._version=this.mono.Version,n&&(this.mountId=this.mono.GetInstanceID(),this.mono.MountId=this.mountId)}contains(e){return!1}attachChildInternal(e){CS.TSF.Oolong.UGUI.DocumentUtils.AttachElement(this.mono,e.mono),e.mountId=this.mountId,e.mono.MountId=this.mountId}removeChildInternal(e){e.mono.Version==e._version&&(CS.TSF.Oolong.UGUI.DocumentUtils.RemoveElement(this.mono,e.mono),e.mountId=void 0,e.mono.MountId=0)}insertChildInternal(e,n){CS.TSF.Oolong.UGUI.DocumentUtils.InsertElement(this.mono,e.mono,n),e.mountId=this.mountId,e.mono.MountId=this.mountId}setAttribute(e,n){return this._version!=this.mono.Version?!0:e=="id"?(this.id=n?.toString(),!0):(this.mono.SetElementAttribute(e,n==null?null:n.toString()),!0)}getAttribute(e){return this._version!=this.mono.Version?null:e=="id"?this.id:this.mono.GetElementAttribute(e)}removeAttribute(e){if(this._version==this.mono.Version){if(e=="id"){this.id=void 0;return}this.mono.SetElementAttribute(e,null)}}addEventListener(e,n){this._version==this.mono.Version&&(this.events[e]=n,this.mono.AddListener(e,r=>w(this,e,r,n)))}removeEventListener(e,n){this._version==this.mono.Version&&(delete this.events[e],this.mono.RemoveListener(e))}},o=class{constructor(t){this.nodeText=t}get parentElement(){return this.parent}get parentNode(){return this.parent}set nodeValue(t){this.nodeText=t,this.parent?.updateText?.()}toJSON(){return{type:"text",text:this.nodeText}}},d=class{constructor(){this.elementIdMap={};this.emptyList=[]}getElementById(t){return this.elementIdMap[t]?.[0]}getElementsById(t){return this.elementIdMap[t]??this.emptyList}createDocumentFragment(){return new a}createElement(t){return new l(t)}createTextNode(t){return new o(t)}},p=class{constructor(){this._hash="#";this._href="/"}get href(){return this._href}get hash(){return this._hash}set href(t){this._href=t}set hash(t){this._hash=t}},m=class{constructor(){this.historyStack=[]}pushState(t,e,n){n=n??s.location.href,this.historyStack.push({state:t,title:e,url:n}),s.location.hash=n,s.location.href=n}replaceState(t,e,n){n=n??s.location.href,this.historyStack.length>0?(this.historyStack[this.historyStack.length-1]={state:t,title:e,url:n},n&&(s.location.hash=n)):(this.historyStack.push({state:t,title:e,url:n}),n&&(s.location.hash=n)),s.location.hash=n,s.location.href=n}},g=class{},f=class{},b=class{constructor(){this.animationFrameQueue=[];this.animationFrameProcessor=[];this.location=new p;this.history=new m;this.document=new d;this.XMLHttpRequest=c;this.FormData=g;this.URLSearchParams=f;this.setTimeout=globalThis.setTimeout}requestAnimationFrame(t){typeof t=="function"&&this.animationFrameQueue.push(t)}addEventListener(t,e){}removeEventListener(t,e){}tick(){let t=this.animationFrameQueue;this.animationFrameQueue=this.animationFrameProcessor,this.animationFrameProcessor=t;for(let e of this.animationFrameProcessor)e();this.animationFrameProcessor.splice(0,this.animationFrameProcessor.length)}},s=new b,F=s,A=i=>s.requestAnimationFrame(i),C=s.document,h=C,I=s.location,_=I,S=s.history,O=S,L=(i,t)=>s.addEventListener(i,t),H=()=>{s.tick()};var T={...v};for(U in T)globalThis[U]=T[U];var U;
